(this["webpackJsonpmoralis-dao-frontend"]=this["webpackJsonpmoralis-dao-frontend"]||[]).push([[4],{1013:function(e,t){},1015:function(e,t){},1017:function(e,t){},1146:function(e,t){},1148:function(e,t){},1155:function(e,t){},1156:function(e,t){},1172:function(e,t){},1174:function(e,t){},1182:function(e,t){},1193:function(e,t){},1259:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n(268),a=n.n(r),c=(n(625),n(626),n(111)),i=n(29),o=n(9),l=n(34),u=n(1),d=n.n(u),b=n(58),j=n(91),p=(n(589),n(6)),x=function(){var e=Object(s.useState)(0),t=Object(l.a)(e,2),n=t[0],r=t[1],a=Object(s.useState)(0),i=Object(l.a)(a,2),u=i[0],x=i[1],f=Object(s.useState)(0),O=Object(l.a)(f,2),h=O[0],m=O[1],v=Object(j.b)(),g=v.Moralis,y=v.isInitialized,w=Object(s.useState)(),N=Object(l.a)(w,2),k=N[0],P=N[1],S=Object(s.useState)(),F=Object(l.a)(S,2),C=F[0],I=F[1],T=Object(j.c)(),V=Object(s.useState)(),A=Object(l.a)(V,2),D=A[0],_=A[1],E=Object(j.d)(),M=function(){var e=Object(o.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={contractAddress:"0xc2f04A841Bf61d92FE312ac0D45FDa02e6577486",functionName:"createProposal",abi:[{inputs:[{internalType:"string",name:"_description",type:"string"},{internalType:"address[]",name:"_canVote",type:"address[]"}],name:"createProposal",outputs:[],stateMutability:"nonpayable",type:"function"}],params:{_description:t,_canVote:C}},e.next=3,E.fetch({params:n,onSuccess:function(){console.log("Proposal Succesful"),_(!1),alert("Transaction completed successfully.")},onError:function(e){alert(e),_(!1)}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(o.a)(d.a.mark((function e(t){var n,s,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.Object.extend("ProposalCounts"),(s=new g.Query(n)).equalTo("proposalId",t),e.next=5,s.first();case 5:if(void 0===(r=e.sent)){e.next=14;break}if(!r.attributes.approved){e.next=11;break}return e.abrupt("return",{color:"green",text:"Passed"});case 11:return e.abrupt("return",{color:"red",text:"Rejected"});case 12:e.next=15;break;case 14:return e.abrupt("return",{color:"blue",text:"Ongoing"});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){if(y){var e=function(){var e=Object(o.a)(d.a.mark((function e(){var t,n,s,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.Object.extend("Proposals"),(n=new g.Query(t)).descending("proposalId_decimal"),e.next=5,n.find();case 5:return s=e.sent,e.next=8,Promise.all(s.map(function(){var e=Object(o.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.attributes.proposalId,e.t1=t.attributes.description,e.t2=p.jsx,e.t3=c.b,e.t4=t.attributes.description,e.next=7,z(t.attributes.proposalId);case 7:return e.t5=e.sent.color,e.next=10,z(t.attributes.proposalId);case 10:return e.t6=e.sent.text,e.t7=t.attributes.proposalId,e.t8=t.attributes.proposer,e.t9={description:e.t4,color:e.t5,text:e.t6,id:e.t7,proposer:e.t8},e.t10=p.jsx,e.t11=b.h,e.next=18,z(t.attributes.proposalId);case 18:return e.t12=e.sent.color,e.next=21,z(t.attributes.proposalId);case 21:return e.t13=e.sent.text,e.t14={color:e.t12,text:e.t13},e.t15=(0,e.t10)(e.t11,e.t14),e.t16={to:"/proposal/",state:e.t9,children:e.t15},e.t17=(0,e.t2)(e.t3,e.t16),e.abrupt("return",[e.t0,e.t1,e.t17]);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:r=e.sent,P(r),x(s.length);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(o.a)(d.a.mark((function e(){var t,n,s,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.Object.extend("ProposalCounts"),n=new g.Query(t),e.next=4,n.find();case 4:s=e.sent,a=0,s.forEach((function(e){e.attributes.approved&&a++})),m(s.length),r(a/s.length*100);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(o.a)(d.a.mark((function e(){var t,n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={address:"0x2953399124F0cBB46d2CbACD8A89cF0599974963",token_id:"67841412279532801837515543174226035610057961491298794127114430528654986444801",chain:"mumbai"},e.next=3,T.token.getTokenIdOwners(t);case 3:n=e.sent,s=n.result.map((function(e){return e.owner_of})),I(s);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n(),e(),t()}else console.log("not initialized")}),[y]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"content",children:Object(p.jsxs)(b.f,{defaultActiveKey:1,tabStyle:"bulbUnion",children:[Object(p.jsx)(b.e,{tabKey:1,tabName:"Proposals",children:k&&Object(p.jsxs)("div",{className:"tabContent",children:["Overview",Object(p.jsxs)("div",{className:"widgets",children:[Object(p.jsx)("div",{className:"first",children:Object(p.jsx)(b.j,{info:u,title:"Proposals Created",children:Object(p.jsxs)("div",{className:"extraWidgetInfo",children:[Object(p.jsx)("div",{className:"extraTitle",children:"Pass Rate"}),Object(p.jsx)("div",{className:"progress",children:Object(p.jsx)("div",{className:"progressPercentage",style:{width:"".concat(n,"%")}})}),Object(p.jsxs)("div",{className:"extraValue",children:[n,"%"]})]})})}),Object(p.jsx)(b.j,{info:C.length,title:"Eligible Voters"}),Object(p.jsx)(b.j,{info:u-h,title:"Ongoing Proposals"})]}),"Recent Proposals",Object(p.jsxs)("div",{className:"newProposal",children:[Object(p.jsx)(b.g,{columnsConfig:"10% 70% 10%",data:k,header:[Object(p.jsx)("span",{style:{margin:"10px 20px"},children:"ID"}),Object(p.jsx)("span",{style:{margin:"10px 20px"},children:"Description"}),Object(p.jsx)("span",{style:{margin:"10px 20px"},children:"Status"})],pageSize:5}),Object(p.jsx)(b.c,{buttonConfig:{isLoading:D,loadingText:"Submitting...",text:"Submit",theme:"secondary"},data:[{inputWidth:"100%",name:"New Proposal",type:"textarea",validation:{required:!0},value:""}],onSubmit:function(e){_(!0),M(e.data[0].inputResult)},title:"Create a New Proposal"})]})]})}),Object(p.jsx)(b.e,{tabKey:2,tabName:"About",children:Object(p.jsxs)("div",{class:"about",children:["NFT proof collection for joining is linked ",Object(p.jsx)("a",{href:"https://testnets.opensea.io/collection/proposal-nft",target:"_blank",rel:"noreferrer",children:"here."}),Object(p.jsx)("br",{}),Object(p.jsx)("br",{}),"Made by ",Object(p.jsx)("a",{href:"https://github.com/priyansh71",target:"_blank",rel:"noreferrer",children:"Priyansh"})," using\xa0",Object(p.jsx)("a",{href:"https://moralis.io",children:"Moralis.io"})]})})]})}),Object(p.jsx)("div",{className:"voting"})]})},f=function(){var e=Object(i.e)().state,t=Object(j.b)(),n=t.Moralis,r=t.isInitialized,a=Object(s.useState)(),u=Object(l.a)(a,2),x=u[0],f=u[1],O=Object(s.useState)(0),h=Object(l.a)(O,2),m=h[0],v=h[1],g=Object(s.useState)(0),y=Object(l.a)(g,2),w=y[0],N=y[1],k=Object(s.useState)([]),P=Object(l.a)(k,2),S=P[0],F=P[1],C=Object(s.useState)(),I=Object(l.a)(C,2),T=I[0],V=I[1],A=Object(j.d)();Object(s.useEffect)((function(){if(r){var t=function(){var t=Object(o.a)(d.a.mark((function t(){var s,r,a,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.Object.extend("Votes"),(r=new n.Query(s)).equalTo("proposal",e.id),r.descending("createdAt"),t.next=6,r.find();case 6:(a=t.sent).length>0&&(f(a[0].attributes),N((Number(a[0].attributes.votesDown)/(Number(a[0].attributes.votesDown)+Number(a[0].attributes.votesUp))*100).toFixed(0)),v((Number(a[0].attributes.votesUp)/(Number(a[0].attributes.votesDown)+Number(a[0].attributes.votesUp))*100).toFixed(0))),c=a.map((function(e){return[e.attributes.voter,Object(p.jsx)(b.d,{fill:e.attributes.votedFor?"#2cc40a":"#d93d3d",size:20,svg:e.attributes.votedFor?"checkmark":"arrowCircleDown"})]})),F(c);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}}),[r]);var D=function(){var t=Object(o.a)(d.a.mark((function t(n){var s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={contractAddress:"0xc2f04A841Bf61d92FE312ac0D45FDa02e6577486",functionName:"voteOnProposal",abi:[{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"bool",name:"_vote",type:"bool"}],name:"voteOnProposal",outputs:[],stateMutability:"nonpayable",type:"function"}],params:{_id:e.id,_vote:n}},t.next=3,A.fetch({params:s,onSuccess:function(){console.log("Vote Cast Succesfully"),V(!1),alert("Transaction completed successfully.")},onError:function(e){alert(e.data.message),V(!1)}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"contentProposal",children:[Object(p.jsxs)("div",{className:"proposal",children:[Object(p.jsx)(c.b,{to:"/",children:Object(p.jsxs)("div",{className:"backHome",children:[Object(p.jsx)(b.d,{fill:"#ffffff",size:20,svg:"chevronLeft"}),"Overview"]})}),Object(p.jsx)("div",{className:"describe",children:e.description}),Object(p.jsxs)("div",{className:"proposalOverview",children:[Object(p.jsx)(b.h,{color:e.color,text:e.text}),Object(p.jsxs)("div",{className:"proposer",children:[Object(p.jsx)("span",{children:"Proposed By "}),Object(p.jsx)(b.i,{content:e.proposer,children:Object(p.jsx)(b.a,{seed:e.proposer})})]})]})]}),x&&Object(p.jsxs)("div",{className:"widgets",children:[Object(p.jsx)(b.j,{info:x.votesUp,title:"Votes For",children:Object(p.jsxs)("div",{className:"extraWidgetInfo",children:[Object(p.jsxs)("div",{className:"extraTitle",children:[m,"%"]}),Object(p.jsx)("div",{className:"progress",children:Object(p.jsx)("div",{className:"progressPercentage",style:{width:"".concat(m,"%")}})})]})}),Object(p.jsx)(b.j,{info:x.votesDown,title:"Votes Against",children:Object(p.jsxs)("div",{className:"extraWidgetInfo",children:[Object(p.jsxs)("div",{className:"extraTitle",children:[w,"%"]}),Object(p.jsx)("div",{className:"progress",children:Object(p.jsx)("div",{className:"progressPercentage",style:{width:"".concat(w,"%")}})})]})})]}),Object(p.jsxs)("div",{className:"votesDiv",children:[Object(p.jsx)(b.g,{style:{width:"400px"},columnsConfig:"80% 20%",data:S,rowKey:"id",header:[Object(p.jsx)("span",{style:{margin:"10px 20px"},children:"Address"}),Object(p.jsx)("span",{style:{margin:"10px 20px"},children:"Vote"})],pageSize:5}),Object(p.jsx)(b.c,{isDisabled:"Ongoing"!==e.text,style:{width:"40px",height:"250px",border:"1px solid rgba(6, 158, 252, 0.2)"},buttonConfig:{isLoading:T,loadingText:"Casting Vote",text:"Vote",theme:"secondary"},data:[{inputWidth:"100%",name:"Cast Your Vote",options:["For","Against"],type:"radios",validation:{required:!0}}],onSubmit:function(e){"For"===e.data[0].inputResult[0]?D(!0):D(!1),V(!0)},title:"Cast Your Vote"})]})]}),Object(p.jsx)("div",{className:"voting2"})]})},O=n.p+"static/media/Moralis.29d45c5c.svg",h=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)(c.b,{to:"/",children:Object(p.jsx)("img",{width:"100px",src:O,alt:"logo"})}),Object(p.jsx)(b.b,{})]}),Object(p.jsxs)(i.c,{children:[Object(p.jsx)(i.a,{path:"/",element:Object(p.jsx)(x,{})}),Object(p.jsx)(i.a,{path:"/proposal",element:Object(p.jsx)(f,{})})]})]})};a.a.render(Object(p.jsx)(j.a,{appId:"ECh7rJk4seHGkjLxzAbSGVdnMl7uAMrF3VsmsFF7",serverUrl:"https://vbo917ukbq06.usemoralis.com:2053/server",children:Object(p.jsx)(c.a,{children:Object(p.jsx)(h,{})})}),document.getElementById("root"))},589:function(e,t,n){},625:function(e,t,n){},626:function(e,t,n){},891:function(e,t){},921:function(e,t){},961:function(e,t){},963:function(e,t){},983:function(e,t){},985:function(e,t){},997:function(e,t){}},[[1259,5,6]]]);
//# sourceMappingURL=main.c23260b8.chunk.js.map